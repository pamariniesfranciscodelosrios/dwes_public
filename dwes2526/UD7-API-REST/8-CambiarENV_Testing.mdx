
## 8 Canbiar .env

En Laravel, puedes configurar una base de datos diferente para los tests modificando el archivo de configuraciÃ³n `phpunit.xml` o gestionÃ¡ndolo directamente en `config/database.php`.

---

### ğŸ”¹ **1. Modificar phpunit.xml**

Laravel usa un entorno especial de testing definido en `phpunit.xml`. Para cambiar la base de datos de pruebas, edita la variable `DB_DATABASE` en la secciÃ³n `<env>`:

```xml
<env name="DB_CONNECTION" value="sqlite"/>
<env name="DB_DATABASE" value="database/databasetesting.sqlite"/>
```

Esto asegurarÃ¡ que las pruebas usen `databasetesting.sqlite` en lugar de `database.sqlite`.

---

### ğŸ”¹ **2. Crear la Base de Datos de Pruebas**

Debes asegurarte de que el archivo `databasetesting.sqlite` existe en la carpeta `database/`. Para crearlo, ejecuta:

```bash
touch database/databasetesting.sqlite
```

---

### ğŸ”¹ **3. Configurar `config/database.php`**

En el archivo `config/database.php`, Laravel define las conexiones de base de datos. Puedes asegurarte de que se use SQLite correctamente en testing agregando una configuraciÃ³n condicional:

```php
'sqlite_testing' => [
    'driver' => 'sqlite',
    'database' => env('DB_DATABASE', database_path('databasetesting.sqlite')),
    'prefix' => '',
    'foreign_key_constraints' => env('DB_FOREIGN_KEYS', true),
],
```

Ahora Laravel usarÃ¡ esta configuraciÃ³n cuando definas `DB_CONNECTION=sqlite_testing` en `.env.testing`.

---

### ğŸ”¹ **4. Modificar el Archivo `.env.testing`**

Laravel usa `.env.testing` al ejecutar pruebas. AsegÃºrate de que tenga la configuraciÃ³n correcta:

```
DB_CONNECTION=sqlite
DB_DATABASE=database/databasetesting.sqlite
```

---

### ğŸ”¹ **5. Ejecutar las Migraciones Antes de las Pruebas**

Laravel no usa la base de datos en memoria por defecto en SQLite, asÃ­ que asegÃºrate de ejecutar las migraciones antes de correr las pruebas:

```bash
php artisan migrate --env=testing
```

TambiÃ©n puedes hacer que las pruebas ejecuten las migraciones automÃ¡ticamente usando `RefreshDatabase` en tus test:

```php
use Illuminate\Foundation\Testing\RefreshDatabase;

class ExampleTest extends TestCase
{
    use RefreshDatabase;

    public function test_example()
    {
        $this->assertTrue(true);
    }
}
```

---

### âœ… **Resumen**

1. **Editar `phpunit.xml`** para cambiar `DB_DATABASE`.
2. **Crear `databasetesting.sqlite`** en `database/`.
3. **Asegurar la configuraciÃ³n en `config/database.php`** .
4. **Configurar `.env.testing` correctamente** .
5. **Ejecutar migraciones antes de probar** o usar `RefreshDatabase`.

Ahora, al ejecutar `php artisan test`, Laravel usarÃ¡ `databasetesting.sqlite` para tus pruebas. ğŸš€
